From f4bbeb3e558488fc90b9fcbd55efd99feef94ea2 Mon Sep 17 00:00:00 2001
From: Sadrul Habib Chowdhury <sadrul@users.sourceforge.net>
Date: Wed, 22 Oct 2008 14:37:29 -0400
Subject: [PATCH] Check for alias in idle callback

---
 src/process.c |   15 ++++++++++-----
 1 files changed, 10 insertions(+), 5 deletions(-)

diff --git a/src/process.c b/src/process.c
index ca8b559..b2245f2 100644
--- a/src/process.c
+++ b/src/process.c
@@ -3210,7 +3210,7 @@ int key;
 		  struct alias *alias = FindAlias(args[1]);
 		  if (!alias)
 		    {
-		      Msg(0, "%s: bind: unknown command '%s'", rc_name, args[1]);
+		      Msg(0, "%s: bind: unknown command or alias '%s'", rc_name, args[1]);
 		      break;
 		    }
 		  i = alias->nr;
@@ -3345,7 +3345,7 @@ int key;
 		  struct alias *alias = FindAlias(args[1]);
 		  if (!alias)
 		    {
-		      Msg(0, "%s: bindkey: unknown command '%s'", rc_name, args[1]);
+		      Msg(0, "%s: bindkey: unknown command or alias '%s'", rc_name, args[1]);
 		      break;
 		    }
 		  newnr = alias->nr;
@@ -4029,10 +4029,15 @@ int key;
 	    {
 	      if ((i = FindCommnr(args[1])) == RC_ILLEGAL)
 		{
-		  Msg(0, "%s: idle: unknown command '%s'", rc_name, args[1]);
-		  break;
+		  struct alias *alias = FindAlias(args[1]);
+		  if (!alias)
+		    {
+		      Msg(0, "%s: idle: unknown command or alias '%s'", rc_name, args[1]);
+		      break;
+		    }
+		  i = alias->nr;
 		}
-	      if (CheckArgNum(i, args + 2) < 0)
+	      if (i <= RC_LAST && CheckArgNum(i, args + 2) < 0)
 		break;
 	      ClearAction(&idleaction);
 	      SaveAction(&idleaction, i, args + 2, argl + 2);
-- 
1.5.6.2

